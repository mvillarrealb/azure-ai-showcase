{
  "info": {
    "name": "Personal Finance API",
    "description": "Una API RESTful para permitir a los usuarios gestionar sus finanzas personales, incluyendo categorías, transacciones, escaneo de facturas y reportes mensuales.",
    "version": "1.0.0",
    "_postman_id": "personal-finance-api-collection",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://api.finanzas-personales.com/v1",
      "description": "Base URL del servidor de la API"
    },
    {
      "key": "stagingUrl",
      "value": "https://staging.api.finanzas-personales.com/v1",
      "description": "Base URL del servidor de staging"
    }
  ],
  "item": [
    {
      "name": "Categorías",
      "description": "Operaciones relacionadas con categorías de transacciones",
      "item": [
        {
          "name": "Obtener todas las categorías",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/categories",
              "host": ["{{baseUrl}}"],
              "path": ["categories"]
            },
            "description": "Devuelve una lista completa de categorías de gastos e ingresos disponibles para clasificar transacciones financieras."
          },
          "response": [
            {
              "name": "Lista de categorías obtenida exitosamente",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/categories",
                  "host": ["{{baseUrl}}"],
                  "path": ["categories"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "[\n  {\n    \"id\": \"cat-001\",\n    \"name\": \"Alimentación\",\n    \"type\": \"expense\"\n  },\n  {\n    \"id\": \"cat-002\",\n    \"name\": \"Transporte\",\n    \"type\": \"expense\"\n  },\n  {\n    \"id\": \"cat-003\",\n    \"name\": \"Salario\",\n    \"type\": \"income\"\n  },\n  {\n    \"id\": \"cat-004\",\n    \"name\": \"Entretenimiento\",\n    \"type\": \"expense\"\n  }\n]"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is a valid JSON array\", function () {",
                  "    pm.response.to.be.json;",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Each category has required fields\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    jsonData.forEach(category => {",
                  "        pm.expect(category).to.have.property('id');",
                  "        pm.expect(category).to.have.property('name');",
                  "        pm.expect(category).to.have.property('type');",
                  "        pm.expect(category.type).to.be.oneOf(['income', 'expense']);",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Transacciones",
      "description": "Operaciones para gestionar transacciones financieras",
      "item": [
        {
          "name": "Obtener todas las transacciones",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/transactions?page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["transactions"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Número de página para la paginación (comienza en 1)"
                },
                {
                  "key": "limit",
                  "value": "20",
                  "description": "Número máximo de transacciones por página"
                },
                {
                  "key": "categoryId",
                  "value": "",
                  "description": "Filtrar transacciones por ID de categoría específica",
                  "disabled": true
                },
                {
                  "key": "startDate",
                  "value": "",
                  "description": "Fecha de inicio para filtrar transacciones (formato ISO 8601)",
                  "disabled": true
                },
                {
                  "key": "endDate",
                  "value": "",
                  "description": "Fecha de fin para filtrar transacciones (formato ISO 8601)",
                  "disabled": true
                }
              ]
            },
            "description": "Devuelve una lista paginada de todas las transacciones financieras del usuario, con opciones de filtrado por fechas y categorías."
          },
          "response": [
            {
              "name": "Lista de transacciones obtenida exitosamente",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/transactions?page=1&limit=20",
                  "host": ["{{baseUrl}}"],
                  "path": ["transactions"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "limit",
                      "value": "20"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"transactions\": [\n    {\n      \"id\": \"txn-001\",\n      \"amount\": -45.50,\n      \"date\": \"2024-11-07T14:30:00Z\",\n      \"categoryId\": \"cat-001\",\n      \"description\": \"Compra en supermercado\"\n    },\n    {\n      \"id\": \"txn-002\",\n      \"amount\": 3000.00,\n      \"date\": \"2024-11-01T09:00:00Z\",\n      \"categoryId\": \"cat-003\",\n      \"description\": \"Salario mensual\"\n    }\n  ],\n  \"pagination\": {\n    \"currentPage\": 1,\n    \"totalPages\": 5,\n    \"totalItems\": 95,\n    \"itemsPerPage\": 20\n  }\n}"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has transactions and pagination\", function () {",
                  "    pm.response.to.be.json;",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('transactions');",
                  "    pm.expect(jsonData).to.have.property('pagination');",
                  "    pm.expect(jsonData.transactions).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Pagination has required fields\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    const pagination = jsonData.pagination;",
                  "    pm.expect(pagination).to.have.property('currentPage');",
                  "    pm.expect(pagination).to.have.property('totalPages');",
                  "    pm.expect(pagination).to.have.property('totalItems');",
                  "    pm.expect(pagination).to.have.property('itemsPerPage');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Crear una nueva transacción - Gasto",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": -25.75,\n  \"date\": \"2024-11-07T16:45:00Z\",\n  \"categoryId\": \"cat-001\",\n  \"description\": \"Almuerzo en restaurante\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/transactions",
              "host": ["{{baseUrl}}"],
              "path": ["transactions"]
            },
            "description": "Permite a los usuarios agregar una nueva transacción de gasto al sistema."
          },
          "response": [
            {
              "name": "Transacción creada exitosamente",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"amount\": -25.75,\n  \"date\": \"2024-11-07T16:45:00Z\",\n  \"categoryId\": \"cat-001\",\n  \"description\": \"Almuerzo en restaurante\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/transactions",
                  "host": ["{{baseUrl}}"],
                  "path": ["transactions"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"id\": \"txn-003\",\n  \"amount\": -25.75,\n  \"date\": \"2024-11-07T16:45:00Z\",\n  \"categoryId\": \"cat-001\",\n  \"description\": \"Almuerzo en restaurante\"\n}"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response is a valid transaction object\", function () {",
                  "    pm.response.to.be.json;",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData).to.have.property('amount');",
                  "    pm.expect(jsonData).to.have.property('date');",
                  "    pm.expect(jsonData).to.have.property('categoryId');",
                  "    pm.expect(jsonData).to.have.property('description');",
                  "});",
                  "",
                  "pm.test(\"Transaction amount matches request\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.amount).to.equal(-25.75);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Crear una nueva transacción - Ingreso",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": 500.00,\n  \"date\": \"2024-11-07T10:00:00Z\",\n  \"categoryId\": \"cat-003\",\n  \"description\": \"Pago freelance\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/transactions",
              "host": ["{{baseUrl}}"],
              "path": ["transactions"]
            },
            "description": "Permite a los usuarios agregar una nueva transacción de ingreso al sistema."
          },
          "response": [
            {
              "name": "Transacción de ingreso creada exitosamente",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"amount\": 500.00,\n  \"date\": \"2024-11-07T10:00:00Z\",\n  \"categoryId\": \"cat-003\",\n  \"description\": \"Pago freelance\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/transactions",
                  "host": ["{{baseUrl}}"],
                  "path": ["transactions"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"id\": \"txn-004\",\n  \"amount\": 500.00,\n  \"date\": \"2024-11-07T10:00:00Z\",\n  \"categoryId\": \"cat-003\",\n  \"description\": \"Pago freelance\"\n}"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response is a valid transaction object\", function () {",
                  "    pm.response.to.be.json;",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData).to.have.property('amount');",
                  "    pm.expect(jsonData).to.have.property('date');",
                  "    pm.expect(jsonData).to.have.property('categoryId');",
                  "    pm.expect(jsonData).to.have.property('description');",
                  "});",
                  "",
                  "pm.test(\"Transaction amount matches request\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.amount).to.equal(500.00);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Facturas",
      "description": "Operaciones para procesar y analizar facturas",
      "item": [
        {
          "name": "Escanear y procesar factura PDF",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "description": "Archivo PDF de la factura a procesar",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/invoices/scan",
              "host": ["{{baseUrl}}"],
              "path": ["invoices", "scan"]
            },
            "description": "Permite a los usuarios subir un archivo PDF de una factura para su análisis automático y extracción de datos mediante OCR e inteligencia artificial."
          },
          "response": [
            {
              "name": "Factura procesada exitosamente",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "file",
                      "type": "file",
                      "src": "invoice-sample.pdf"
                    }
                  ]
                },
                "url": {
                  "raw": "{{baseUrl}}/invoices/scan",
                  "host": ["{{baseUrl}}"],
                  "path": ["invoices", "scan"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"invoiceNumber\": \"INV-2024-001234\",\n  \"date\": \"2024-11-05T00:00:00Z\",\n  \"totalAmount\": 127.50,\n  \"vendor\": \"Supermercado La Esperanza\",\n  \"lineItems\": [\n    {\n      \"description\": \"Pan integral\",\n      \"quantity\": 2,\n      \"unitPrice\": 3.50,\n      \"totalPrice\": 7.00\n    },\n    {\n      \"description\": \"Leche descremada 1L\",\n      \"quantity\": 1,\n      \"unitPrice\": 4.25,\n      \"totalPrice\": 4.25\n    },\n    {\n      \"description\": \"Manzanas rojas (kg)\",\n      \"quantity\": 1.5,\n      \"unitPrice\": 6.80,\n      \"totalPrice\": 10.20\n    }\n  ]\n}"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response contains invoice analysis data\", function () {",
                  "    pm.response.to.be.json;",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('invoiceNumber');",
                  "    pm.expect(jsonData).to.have.property('date');",
                  "    pm.expect(jsonData).to.have.property('totalAmount');",
                  "    pm.expect(jsonData).to.have.property('vendor');",
                  "    pm.expect(jsonData).to.have.property('lineItems');",
                  "    pm.expect(jsonData.lineItems).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Line items have required fields\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    jsonData.lineItems.forEach(item => {",
                  "        pm.expect(item).to.have.property('description');",
                  "        pm.expect(item).to.have.property('quantity');",
                  "        pm.expect(item).to.have.property('unitPrice');",
                  "        pm.expect(item).to.have.property('totalPrice');",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Reportes",
      "description": "Generación de reportes e informes financieros",
      "item": [
        {
          "name": "Obtener reporte financiero mensual",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/reports/monthly?month=2024-11",
              "host": ["{{baseUrl}}"],
              "path": ["reports", "monthly"],
              "query": [
                {
                  "key": "month",
                  "value": "2024-11",
                  "description": "Mes para el reporte en formato YYYY-MM (ejemplo 2024-11)"
                }
              ]
            },
            "description": "Devuelve un informe detallado de gastos e ingresos para un mes específico, incluyendo totales y desglose por categorías."
          },
          "response": [
            {
              "name": "Reporte mensual generado exitosamente",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/reports/monthly?month=2024-11",
                  "host": ["{{baseUrl}}"],
                  "path": ["reports", "monthly"],
                  "query": [
                    {
                      "key": "month",
                      "value": "2024-11"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"month\": \"2024-11\",\n  \"totalIncome\": 3500.00,\n  \"totalExpense\": 2750.25,\n  \"netSavings\": 749.75,\n  \"categoryBreakdown\": [\n    {\n      \"categoryId\": \"cat-003\",\n      \"totalAmount\": 3500.00\n    },\n    {\n      \"categoryId\": \"cat-001\",\n      \"totalAmount\": -890.50\n    },\n    {\n      \"categoryId\": \"cat-002\",\n      \"totalAmount\": -450.00\n    },\n    {\n      \"categoryId\": \"cat-004\",\n      \"totalAmount\": -320.75\n    }\n  ]\n}"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response contains monthly report data\", function () {",
                  "    pm.response.to.be.json;",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('month');",
                  "    pm.expect(jsonData).to.have.property('totalIncome');",
                  "    pm.expect(jsonData).to.have.property('totalExpense');",
                  "    pm.expect(jsonData).to.have.property('netSavings');",
                  "    pm.expect(jsonData).to.have.property('categoryBreakdown');",
                  "    pm.expect(jsonData.categoryBreakdown).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Category breakdown has required fields\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    jsonData.categoryBreakdown.forEach(category => {",
                  "        pm.expect(category).to.have.property('categoryId');",
                  "        pm.expect(category).to.have.property('totalAmount');",
                  "    });",
                  "});",
                  "",
                  "pm.test(\"Net savings calculation is correct\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    const expectedSavings = jsonData.totalIncome - jsonData.totalExpense;",
                  "    pm.expect(jsonData.netSavings).to.equal(expectedSavings);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Script global que se ejecuta antes de cada request",
          "// Aquí puedes configurar autenticación, headers comunes, etc.",
          "console.log('Ejecutando request a:', pm.request.url.toString());"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Script global que se ejecuta después de cada response",
          "// Validaciones comunes para todas las respuestas",
          "pm.test(\"Response time is less than 5000ms\", function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(5000);",
          "});",
          "",
          "pm.test(\"Content-Type header is present\", function () {",
          "    pm.response.to.have.header(\"Content-Type\");",
          "});"
        ]
      }
    }
  ]
}